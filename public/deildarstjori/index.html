<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <title>DeildarstjÃ³rasvÃ¦Ã°i - FjÃ¶rlistinn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="description" content="MÃ¦tingarkerfi fyrir fÃ©lagsmiÃ°stÃ¶Ã°var ReykjanesbÃ¦jar" />
  <meta name="theme-color" content="#8B5CF6" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="FjÃ¶rlistinn" />
  
  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/svg+xml" href="/assets/icons/icon.svg" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Shared CSS -->
  <link rel="stylesheet" href="/css/shared/base.css">
  <link rel="stylesheet" href="/css/shared/buttons.css">
  <link rel="stylesheet" href="/css/shared/forms.css">
  <link rel="stylesheet" href="/css/shared/cards.css">
  <link rel="stylesheet" href="/css/shared/loading.css">
  <link rel="stylesheet" href="/css/shared/modals.css">
  
  <!-- Component CSS -->
  <link rel="stylesheet" href="/css/components/login.css">
  <link rel="stylesheet" href="/css/components/header.css">
  <link rel="stylesheet" href="/css/components/tabs.css">
  
  
</head>
<body>
  

<link rel="stylesheet" href="/css/components/attendance.css">
<link rel="stylesheet" href="/css/components/calendar.css">
<link rel="stylesheet" href="/css/components/charts.css">
<link rel="stylesheet" href="/css/components/student-popup.css">
<link rel="stylesheet" href="/css/components/autocomplete.css">
<link rel="stylesheet" href="/css/components/virkni.css">
<link rel="stylesheet" href="/css/pages/staff.css">



<div class="login-view" id="centerSelectView">
  <div class="login-card" style="max-width: 500px;">
    <div class="login-header">
      <div class="login-icon">ğŸ“</div>
      <h1 class="login-title">DeildarstjÃ³rasvÃ¦Ã°i</h1>
      <p style="color: var(--color-text-muted); margin-top: 8px;">Veldu fÃ©lagsmiÃ°stÃ¶Ã°</p>
    </div>

    <div class="center-select-grid">
      <button class="center-select-btn" data-center="HAFNOFELO" style="--btn-color: #8B5CF6; background: linear-gradient(135deg, #f97316, #eab308, #22c55e, #3b82f6, #8b5cf6, #ec4899);">
        <span class="center-select-name">FjÃ¶r HafnÃ³</span>
      </button>
      <button class="center-select-btn" data-center="STAPAFELO" style="--btn-color: #8B5CF6;">
        <span class="center-select-name">FjÃ¶r Stapa</span>
      </button>
      <button class="center-select-btn" data-center="AKURFELO" style="--btn-color: #EAB308;">
        <span class="center-select-name">FjÃ¶r Akur</span>
      </button>
      <button class="center-select-btn" data-center="HAALEITIFELO" style="--btn-color: #EC4899;">
        <span class="center-select-name">FjÃ¶r HÃ¡aleiti</span>
      </button>
    </div>

    <div class="login-footer">
      <a href="index.html">â† Til baka Ã¡ forsÃ­Ã°u</a>
    </div>
  </div>
</div>


<div class="login-view" id="loginView" style="display: none;">
  <div class="login-card">
    <div class="login-header">
      <div class="login-icon">ğŸ”</div>
      <h1 class="login-title">DeildarstjÃ³rasvÃ¦Ã°i</h1>
      <p class="login-center-name" id="loginCenterName">FjÃ¶rlistinn</p>
    </div>

    <form id="loginForm">
      <div class="form-group">
        <label class="form-label">LykilorÃ°</label>
        <input type="password" class="form-input" id="loginPassword" placeholder="LykilorÃ° stÃ¶Ã°varinnar..." required />
      </div>

      <button type="submit" class="btn" id="loginBtn">SkrÃ¡ inn</button>
    </form>

    <div class="login-error" id="loginError">
      Rangt lykilorÃ°
    </div>

    <div class="login-footer">
      <a href="index.html">â† Til baka Ã¡ forsÃ­Ã°u</a>
    </div>
  </div>
</div>


<div class="main-view" id="mainView">
  
<header class="header">
  <div class="header-left">
    <div class="header-center-name" id="headerCenterName">FjÃ¶r</div>
    <div class="header-date" id="headerDate"></div>
  </div>
  <div class="header-right">
    <span class="user-name" id="userName"></span>
    <button class="logout-btn" onclick="logout()">ÃštskrÃ¡</button>
  </div>
</header>

  
  
<div class="tabs-container">
  <div class="tabs">
    <button class="tab active" data-tab="maeting">ğŸ“‹ MÃ¦ting dagsins</button>
    <button class="tab" data-tab="tolfraedi">ğŸ“Š TÃ¶lfrÃ¦Ã°i</button>
    <button class="tab" data-tab="midstig">ğŸ“ MiÃ°stig</button>
    <button class="tab" data-tab="uppfletting">ğŸ” Uppfletting</button>
    <button class="tab" data-tab="virkni">ğŸ‘¥ Virkni</button>
    
    <button class="tab" data-tab="leaderboard">ğŸ† Stigatafla</button>
    
    <button class="tab" data-tab="nyr-nemandi">â• NÃ½r nemandi</button>
    <button class="tab" data-tab="skra-maeting">âœï¸ SkrÃ¡ mÃ¦tingu</button>
    <button class="tab" data-tab="kiosk">ğŸ”’ Kiosk</button>
  </div>
</div>

  
  <div class="content">
    
<div class="tab-content active" id="tab-maeting">
  <div class="current-activity" id="currentActivity">
    <div class="activity-info">
      <span class="activity-icon">ğŸ“‹</span>
      <div>
        <div class="activity-name" id="activityName">SÃ¦ki upplÃ½singar...</div>
        <div class="activity-time" id="activityTime"></div>
      </div>
    </div>
    <div style="text-align: right;">
      <div class="activity-count" id="activityCount">-</div>
      <div class="activity-count-label">nemendur</div>
    </div>
  </div>

  <div class="section-title">MÃ¦tingalisti</div>
  
  
  <div class="date-navigation">
    <button class="date-nav-btn" id="prevDayBtn" onclick="changeDate(-1)">â†</button>
    <div class="date-display" id="dateDisplay">Ã dag</div>
    <button class="date-nav-btn" id="nextDayBtn" onclick="changeDate(1)" disabled>â†’</button>
  </div>
  
  <div class="attendance-list" id="attendanceList">
    <div class="loading">
      <div class="loading-spinner"></div>
      <p>SÃ¦ki mÃ¦tingar...</p>
    </div>
  </div>

  
  <div class="attendance-legend" id="attendanceLegend" style="display: none;">
    <div class="legend-item">
      <span class="legend-icon">ğŸ”¥</span>
      <span>Vikur Ã­ rÃ¶Ã°</span>
    </div>
    <div class="legend-item">
      <span class="legend-icon">âš ï¸</span>
      <span>10+ dagar frÃ¡ mÃ¦tingu</span>
    </div>
    <div class="legend-item">
      <span class="legend-icon">â­</span>
      <span>Fyrsta mÃ¦ting</span>
    </div>
  </div>

  <div class="card">
    <div class="section-title">ğŸ“Š SundurliÃ°un</div>
    <div class="breakdown" id="attendanceBreakdown"></div>
  </div>

  
  
<div class="calendar-section">
  <div class="calendar-header">
    <button class="calendar-nav-btn" id="prevMonth">â†</button>
    <h2 id="calendarTitle">Desember 2025</h2>
    <button class="calendar-nav-btn" id="nextMonth">â†’</button>
  </div>
  
  <div class="calendar-weekdays">
    <div class="calendar-weekday">MÃ¡nudagur</div>
    <div class="calendar-weekday">ÃriÃ°judagur</div>
    <div class="calendar-weekday">MiÃ°vikudagur</div>
    <div class="calendar-weekday">Fimmtudagur</div>
    <div class="calendar-weekday">FÃ¶studagur</div>
  </div>
  
  <div id="calendarGrid" class="calendar-grid"></div>
  
  <div class="calendar-loading" id="calendarLoading">
    <div class="spinner"></div>
    <p>SÃ¦ki dagatal...</p>
  </div>
</div>

</div>

    
<div class="tab-content" id="tab-tolfraedi">
  <div class="stats-grid" id="statsGrid">
    <div class="stat-card">
      <div class="stat-value" id="statDay">-</div>
      <div class="stat-label">SÃ­Ã°asta opnun</div>
      <div class="stat-change" id="statDayChange"></div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="statWeek">-</div>
      <div class="stat-label">SÃ­Ã°ustu 5 opnanir</div>
      <div class="stat-change" id="statWeekChange"></div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="statMonth">-</div>
      <div class="stat-label">SÃ­Ã°ustu 10 opnanir</div>
      <div class="stat-change" id="statMonthChange"></div>
    </div>
  </div>

  <div class="chart-container">
    <div class="chart-title">ğŸ“ˆ MÃ¦ting eftir opnunum</div>
    <div class="bar-chart" id="weeklyChart"></div>
  </div>

  <div class="chart-container">
    <div class="chart-title">ğŸ« Eftir skÃ³lum</div>
    <div class="horizontal-bar-chart" id="schoolChart"></div>
  </div>

  <div class="chart-container">
    <div class="chart-title">ğŸ“š Eftir bekkjum</div>
    <div class="horizontal-bar-chart" id="gradeChart"></div>
  </div>
</div>

    
<div class="tab-content" id="tab-midstig">
  <div class="section-title">ğŸ“ SkrÃ¡ miÃ°stigsmÃ¦tingu (5.-7. bekkur)</div>

  <div class="card">
    <table class="midstig-table">
      <thead>
        <tr>
          <th>SkÃ³li</th>
          <th>5. bekk</th>
          <th>6. bekk</th>
          <th>7. bekk</th>
          <th>Samtals</th>
        </tr>
      </thead>
      <tbody id="midstigTableBody">
        
      </tbody>
      <tfoot>
        <tr>
          <td>Samtals</td>
          <td id="midstigTotal5">0</td>
          <td id="midstigTotal6">0</td>
          <td id="midstigTotal7">0</td>
          <td id="midstigTotalAll">0</td>
        </tr>
      </tfoot>
    </table>

    <button class="btn" style="margin-top: 20px;" onclick="submitMidstig()">SkrÃ¡ miÃ°stigsmÃ¦tingu</button>
  </div>

  <div class="previous-entries">
    <div class="section-title">ğŸ• Fyrri skrÃ¡ningar Ã­ dag</div>
    <div id="previousMidstig"></div>
  </div>
</div>

    
<div class="tab-content" id="tab-uppfletting">
  <div class="search-bar">
    <input type="text" class="form-input" id="searchInput" placeholder="Leita aÃ° nemanda..." />
    <select id="schoolFilter">
      <option value="">Allir skÃ³lar</option>
    </select>
  </div>

  <div id="searchResults">
    <div class="empty-state">
      <div class="empty-state-icon">ğŸ”</div>
      <p>SlÃ¡Ã°u inn nafn til aÃ° leita</p>
    </div>
  </div>

  <div id="studentDetail" style="display: none;"></div>
</div>

    
<div class="tab-content" id="tab-virkni">
  <div class="section-title">ğŸ“Š Virkniflokkar (sÃ­Ã°ustu 8 vikur)</div>

  <div class="activity-grid" id="activityGrid">
    <div class="activity-card virkir" data-status="virkir">
      <div class="activity-card-icon">ğŸŸ¢</div>
      <div class="activity-card-count" id="countVirkir">-</div>
      <div class="activity-card-label">Virkir</div>
    </div>
    <div class="activity-card ad-detta" data-status="ad_detta">
      <div class="activity-card-icon">ğŸŸ¡</div>
      <div class="activity-card-count" id="countAdDetta">-</div>
      <div class="activity-card-label">AÃ° detta Ãºr</div>
    </div>
    <div class="activity-card nylega-haettir" data-status="nylega_haettir">
      <div class="activity-card-icon">ğŸŸ </div>
      <div class="activity-card-count" id="countNylegaHaettir">-</div>
      <div class="activity-card-label">NÃ½lega hÃ¦ttir</div>
    </div>
    <div class="activity-card haettir" data-status="haettir">
      <div class="activity-card-icon">ğŸ”´</div>
      <div class="activity-card-count" id="countHaettir">-</div>
      <div class="activity-card-label">HÃ¦ttir</div>
    </div>
    <div class="activity-card ovirkir" data-status="ovirkir">
      <div class="activity-card-icon">âšª</div>
      <div class="activity-card-count" id="countOvirkir">-</div>
      <div class="activity-card-label">Ã“virkir</div>
    </div>
  </div>

  <div class="activity-breakdown" id="activityBreakdown">
    <div class="activity-info-text">
      â„¹ï¸ Smelltu Ã¡ flokk til aÃ° sjÃ¡ sundurliÃ°un eftir skÃ³lum
    </div>
  </div>
</div>

    
<div class="tab-content" id="tab-leaderboard">
  <div class="section-title">ğŸ† Stigatafla</div>

  <div class="card">
    <div class="form-group">
      <label class="form-label">TÃ­mabil</label>
      <select class="form-select" id="leaderboardPeriod" onchange="loadLeaderboard()">
        <option value="week">Ãessi vika</option>
        <option value="month" selected>Ãessi mÃ¡nuÃ°ur</option>
        <option value="year">Ãetta skÃ³laÃ¡r</option>
        <option value="all">Allt tÃ­mabil</option>
      </select>
    </div>
  </div>

  <div id="leaderboardList">
    <div class="loading">
      <div class="loading-spinner"></div>
      <p>SÃ¦ki stigatÃ¶flu...</p>
    </div>
  </div>
</div>

    
<div class="tab-content" id="tab-nyr-nemandi">
  <div class="section-title">â• BÃ¦ta viÃ° nemanda</div>

  <div class="add-student-info">
    â„¹ï¸ NotaÃ°u Ã¾etta til aÃ° bÃ¦ta viÃ° nemendum Ãºr skÃ³lum utan ReykjanesbÃ¦jar. 
    Nemandinn getur sÃ­Ã°an merkt mÃ¦tingu Ã­ Ã¶llum fÃ©lagsmiÃ°stÃ¶Ã°vum.
  </div>

  <div class="card add-student-form">
    <div class="form-group">
      <label class="form-label">Nafn</label>
      <input type="text" class="form-input" id="newStudentName" placeholder="Fullt nafn..." />
    </div>

    <div class="form-group">
      <label class="form-label">SkÃ³li</label>
      <select class="form-input" id="newStudentSchool" style="width: 100%;">
        <option value="">Veldu skÃ³la...</option>
        <option value="AkurskÃ³li">AkurskÃ³li</option>
        <option value="StapaskÃ³li">StapaskÃ³li</option>
        <option value="HÃ¡leitisskÃ³li">HÃ¡leitisskÃ³li</option>
        <option value="MyllubakkaskÃ³li">MyllubakkaskÃ³li</option>
        <option value="NjarÃ°vÃ­kurskÃ³li">NjarÃ°vÃ­kurskÃ³li</option>
        <option value="HeiÃ°arskÃ³li">HeiÃ°arskÃ³li</option>
        <option value="HoltaskÃ³li">HoltaskÃ³li</option>
        <option value="AÃ°rir skÃ³lar">AÃ°rir skÃ³lar</option>
      </select>
    </div>

    <div class="form-group" id="customSchoolGroup" style="display: none;">
      <label class="form-label">Heiti skÃ³la</label>
      <input type="text" class="form-input" id="customSchoolName" placeholder="SlÃ¡Ã°u inn heiti skÃ³la..." />
    </div>

    <div class="form-group">
      <label class="form-label">Bekkur</label>
      <select class="form-input" id="newStudentGrade" style="width: 100%;">
        <option value="8">8. bekkur</option>
        <option value="9">9. bekkur</option>
        <option value="10">10. bekkur</option>
      </select>
    </div>

    <button class="btn" onclick="addNewStudent()">BÃ¦ta viÃ° nemanda</button>

    <div class="success-message" id="addStudentSuccess">
      âœ… Nemandi bÃ¦ttur viÃ°! LykilorÃ°: <span id="newStudentPassword"></span>
    </div>
  </div>
</div>

    
<div class="tab-content" id="tab-skra-maeting">
  <div class="section-title">âœï¸ SkrÃ¡ mÃ¦tingu handvirkt</div>
  
  <div id="skraMessage"></div>
  
  <div class="skra-form">
    <div class="form-group">
      <label>ğŸ“… Dagsetning</label>
      <input type="date" id="skraDagsetning" />
    </div>
    
    <div class="form-group">
      <label>ğŸ• DagskrÃ¡rliÃ°ur</label>
      <select id="skraDagskrarlid">
        <option value="">Veldu dagskrÃ¡rliÃ°...</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>ğŸ‘¤ Nemandi</label>
      <div class="autocomplete-wrapper">
        <input type="text" id="skraNemandi" placeholder="ByrjaÃ°u aÃ° skrifa nafn..." autocomplete="off" />
        <div class="autocomplete-results" id="autocompleteResults"></div>
      </div>
      <div id="selectedStudent"></div>
    </div>
    
    <button class="btn-skra" id="btnSkraMaeting" disabled>âœ” SkrÃ¡ mÃ¦tingu</button>
  </div>
  
  <div class="nylega-skrad">
    <h4>ğŸ• NÃ½lega skrÃ¡Ã° af Ã¾Ã©r</h4>
    <div id="nylegaSkradList">
      <p style="color: var(--color-text-muted); font-size: 0.9rem;">Engar skrÃ¡ningar enn...</p>
    </div>
  </div>
</div>

    
<div class="tab-content" id="tab-kiosk">
  <div class="section-title">ğŸ”’ Kiosk Mode</div>
  <div class="skra-form">
    <p style="color: var(--color-text-muted); margin-bottom: 24px; line-height: 1.6;">
      Kiosk mode lÃ¦sir skjÃ¡inn Ã¡ mÃ¦tingarviÃ°mÃ³ti fyrir iPad eÃ°a snjalltÃ¦ki viÃ° hurÃ°ina. 
      Nemendur geta skrÃ¡Ã° mÃ¦tingu og skoÃ°aÃ° MÃ­n sÃ­Ã°a (meÃ° 20 sek timer).
      Til aÃ° opna Ã¾arf lykilorÃ°.
    </p>
    
    <div class="kiosk-features" style="margin-bottom: 24px;">
      <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
        <span style="font-size: 1.2rem;">âœ”</span>
        <div>
          <div style="font-weight: 500;">LÃ¦st viÃ°mÃ³t</div>
          <div style="font-size: 0.9rem; color: var(--color-text-muted);">Nemendur geta ekki fariÃ° Ãºr mÃ¦tingarskjÃ¡num</div>
        </div>
      </div>
      <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
        <span style="font-size: 1.2rem;">âœ”</span>
        <div>
          <div style="font-weight: 500;">MÃ­n sÃ­Ã°a meÃ° timer</div>
          <div style="font-size: 0.9rem; color: var(--color-text-muted);">Nemendur geta sÃ©Ã° sÃ­na tÃ¶lfrÃ¦Ã°i Ã­ 20 sek</div>
        </div>
      </div>
      <div style="display: flex; align-items: flex-start; gap: 12px;">
        <span style="font-size: 1.2rem;">âœ”</span>
        <div>
          <div style="font-weight: 500;">LykilorÃ°svÃ¶rn</div>
          <div style="font-size: 0.9rem; color: var(--color-text-muted);">AÃ°eins starfsfÃ³lk getur opnaÃ° kioskinn</div>
        </div>
      </div>
    </div>

    <button class="btn" onclick="openKioskMode()">ğŸš€ Opna Kiosk Mode</button>
  </div>
</div>

  </div>
</div>


<div class="student-popup-overlay" id="studentPopupOverlay">
  <div class="student-popup" id="studentPopup">
    
  </div>
</div>



<script src="/js/components/tabs.js"></script>
<script src="/js/components/calendar.js"></script>
<script src="/js/components/student-popup.js"></script>
<script src="/js/pages/staff/init.js"></script>
<script src="/js/pages/staff/maeting.js"></script>
<script src="/js/pages/staff/tolfraedi.js"></script>
<script src="/js/pages/staff/midstig.js"></script>
<script src="/js/pages/staff/uppfletting.js"></script>
<script src="/js/pages/staff/virkni.js"></script>
<script src="/js/pages/staff/skra-maeting.js"></script>
<script src="/js/pages/staff/leaderboard.js"></script>
<script src="/js/pages/staff/nyr-nemandi.js"></script>

<script>
  // Set role to deildarstjori
  currentUserRole = 'deildarstjori';
</script>



  
  <!-- Shared JS -->
  <script src="/js/shared/config.js"></script>
  <script src="/js/shared/api.js"></script>
  <script src="/js/shared/utils.js"></script>
  <script src="/js/shared/state.js"></script>
  <script src="/js/shared/auth.js"></script>
  
  
  
  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => console.log('FjÃ¶rlistinn SW registered'))
          .catch(err => console.log('FjÃ¶rlistinn SW failed:', err));
      });
    }
  </script>
</body>
</html>
